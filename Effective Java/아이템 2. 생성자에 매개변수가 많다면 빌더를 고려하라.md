## Weakness of Static Factory Method and Constructor
- 선택적 매개변수가 많을 때 적절한 대응이 어려움
### Telescoping Constructor Pattern
- 필수 매개변수만 받는 생성자, 필수 매개변수와 선택 매개변수 1개를 받는 생성자, 선택 매개변수를 2개까지 받는 생성자, ... 형태로 매개변수를 전부 다 받는 생성자까지 늘려가는 방식
	```java
	public class Example {
		private final int a;
		private final int b;
		private final int c;

		public Example(int a) {
			this(a, 0, 0);
		}

		public Example(int a, int b) {
			this(a, b, 0);
		}

		public Example(int a, int b, int c) {
			this(a, b, c);
		}
	}
	```
- 매개변수의 수가 많아지면 클라이언트 코드를 작성하거나 읽기 어려움
	- 코드를 읽을 때 각 값의 의미 파악이 어려움
	- 타입이 같은 매개변수가 연달아 있다면 찾기 어려운 버그로 이어질 수 있음
	- 클라이언트가 실수로 매개변수 순서를 바꿔 건네줘도 컴파일러는 파악할 수 없고 이는 [[아이템 51. 메서드 시그니처를 신중히 설계하라|런타임에서 엉뚱한 동작]]으로 이어짐

### JavaBeans Pattern
- 매개변수가 없는 생성자로 객체를 만든 후, `setter` 호출을 통한 값 설정
	```java
	public class Example {
		private int a;
		private int b;
		private int c;

		public Example() { }

		public void setA(int a) {
			this.a = a;
		}

		public void setB(int b) {
			this.b = b;
		}

		public void setC(int c) {
			this.c = c;
		}

	}
	```
- 객체 하나를 만들기 위해서 메서드를 여러개 호출해야 하고, 객체가 완전히 생성되기 전까지 일관성이 무너짐
	- 일관성이 무너지는 문제 때문에 자바빈즈 패턴에서는 [[아이템 17. 변경 가능성을 최소화하라|클래스를 불변으로 만들 수 없고]] 스레드 안정성 작업을 따로 해줘야함
		- 이를 위해 `freezing`을 사용하는 경우가 있으나 컴파일러 보증이 이뤄지지 않아 런타임 오류에 취약함

## Builder Pattern
- 필요한 객체를 직접 만드는 대신, 빌더 객체에 원하는 값을 설정한 후 빌더 객체를 통해 생성함
	```java
	Example.builder()
		.a(1)
		.b(2)
		.c(3)
		.build();
	```
- 빌더 패턴은 명명된 선택적 매개변수를 흉내낸 것
- 잘못된 매개변수 검증을 위해서는 빌더 메서드에서 검증을 거치고 생성자에서 불변식 검사를 진행함
- 공격에 대비해 불변식을 보장하기 위해서는 [[아이템 50. 적시에 방어적 복사본을 만들어라|빌더로부터 매개변수를 복사해서 해당 객체 필드도 검사해야함]]
	- 불변: 어떠한 변경도 허용하지 않는다
	- 불변식: 프로그램이 실행되는 동안, 혹은 정해진 기간 동안 반드시 만족해야 하는 조건
- 검증에 실패하면 어떤 매개변수가 잘못되었는지 [[아이템 75. 예외의 상세 메시지에 실패 관련 정보를 담으라|IllegalArgumentException에 메세지를 담아 던지기]]
- 빌더 패턴은 계층적으로 설계된 클래스와 함께 사용하기 적합함
	- 상위 클래스의 빌더를 [[아이템 30. 이왕이면 제네릭 메서드로 만들라|재귀적 타입 한정]]을 이용하는 제네릭 타입으로 구현해 하위 클래스 형변환 없이 연쇄 지원 가능
		- 시뮬레이트한 셀프 타입 관용구 활용
- 빌더를 사용하면 가변인수 매개변수를 여러개 사용할 수 있음

### Con
- 객체 생성을 위해 빌더가 선행됨 → 사소한 성능상의 이슈
- 점층적 생성자 패턴보다 코드가 장황해 매개변수가 4개 이상은 되어야 값어치를 함

## Conclusion
> 생성자나 정적 팩토리가 처리해야할 매개변수가 많다면 빌더 패턴을 선택하는 게 더 낫다. 매개변수 중 다수가 필수가 아니거나 같은 타입이면 특히 더 그렇다. 빌더는 점층적 생성자보다 클라이언트 코드를 읽고 쓰기가 훨씬 간결하고, 자바빈즈보다 훨씬 안전하다.